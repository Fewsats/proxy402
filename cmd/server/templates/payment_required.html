<!DOCTYPE html>
<html>
<head>
    {{if .GoogleAnalyticsID}}
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{.GoogleAnalyticsID}}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', '{{.GoogleAnalyticsID}}');
    </script>
    {{end}}
    
    <!-- Dynamic Title based on provided content -->
    <title>{{if .Title}}{{.Title}}{{else if eq .ResourceType "file"}}{{if .OriginalFilename}}{{.OriginalFilename}}{{else}}File{{end}} - Payment Required{{else}}Payment Required - Proxy402{{end}}</title>
    
    <!-- Dynamic Description -->
    <meta name="description" content="{{if .Description}}{{.Description}}{{else if eq .ResourceType "file"}}Payment required to access {{if .OriginalFilename}}{{.OriginalFilename}}{{else}}this file{{end}}. Secured by Proxy402.{{else}}Payment required to access this content. Secured by Proxy402.{{end}}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#1e2b4a">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{if .Title}}{{.Title}}{{else if eq .ResourceType "file"}}{{if .OriginalFilename}}{{.OriginalFilename}}{{else}}File{{end}} - Payment Required{{else}}Payment Required - Proxy402{{end}}">
    <meta property="og:description" content="{{if .Description}}{{.Description}}{{else if eq .ResourceType "file"}}Payment required to access {{if .OriginalFilename}}{{.OriginalFilename}}{{else}}this file{{end}}. Secured by Proxy402.{{else}}Payment required to access this content. Secured by Proxy402.{{end}}">
    <meta property="og:image" content="{{if .CoverURL}}{{.CoverURL}}{{else}}/static/img/og-payment.png{{end}}">
    <meta property="og:url" content="{{.Resource}}">
    <meta property="og:site_name" content="Proxy402">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{if .Title}}{{.Title}}{{else if eq .ResourceType "file"}}{{if .OriginalFilename}}{{.OriginalFilename}}{{else}}File{{end}} - Payment Required{{else}}Payment Required - Proxy402{{end}}">
    <meta name="twitter:description" content="{{if .Description}}{{.Description}}{{else if eq .ResourceType "file"}}Payment required to access {{if .OriginalFilename}}{{.OriginalFilename}}{{else}}this file{{end}}. Secured by Proxy402.{{else}}Payment required to access this content. Secured by Proxy402.{{end}}">
    <meta name="twitter:image" content="{{if .CoverURL}}{{.CoverURL}}{{else}}/static/img/og-payment.png{{end}}">
    <meta name="twitter:site" content="@fewsats">
    
    <!-- Additional Tags for Improved Shareability -->
    <meta property="og:price:amount" content="{{.AmountFormatted}}">
    <meta property="og:price:currency" content="USD">
    <meta property="product:price:amount" content="{{.AmountFormatted}}">
    <meta property="product:price:currency" content="USD">
    
    <!-- Additional Tags -->
    <meta name="robots" content="index, follow"> <!-- Changed to allow indexing for better discoverability -->
    <meta name="monetization" content="$ilp.uphold.com/PAYMENT_POINTER">
    <link rel="canonical" href="{{.Resource}}">

    <!-- Favicon -->
    <link rel="icon" href="/static/img/favicon.svg" type="image/svg+xml">
    <!-- Include Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- External CSS -->
    <link rel="stylesheet" href="/static/css/style.css">

    <style>
        body {
            background-color: #1e2b4a;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        
        .payment-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background-color: #23395d;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .payment-header {
            margin-bottom: 30px;
        }
        
        .payment-title {
            color: #fff;
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .payment-subtitle {
            color: #bbd0ff;
            font-size: 16px;
        }
        
        .payment-details {
            background-color: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: left;
        }
        
        .payment-detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .detail-label {
            font-weight: 500;
            color: #bbd0ff;
        }
        
        .detail-value {
            color: #fff;
            word-break: break-all;
        }
        
        .instruction-step {
            margin-bottom: 15px;
            color: #bbd0ff;
        }
        
        .instruction-step strong {
            color: #fff;
        }
        
        .payment-footer {
            margin-top: 30px;
            font-size: 14px;
            color: #8ba3d4;
        }
        
        .payment-footer a {
            color: #79a9ff;
            text-decoration: none;
        }
        
        .payment-footer a:hover {
            text-decoration: underline;
        }
        
        .logo {
            margin-bottom: 20px;
            max-width: 150px;
        }
        
        .error-message {
            background-color: rgba(220, 50, 50, 0.2);
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: left;
            color: #ff9d9d;
            border-left: 4px solid #c62828;
        }
        
        .resource-name {
            font-weight: bold;
            color: #fff;
            word-break: break-word;
        }

        /* Cover image styling */
        .cover-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .resource-description {
            color: #bbd0ff;
            margin-bottom: 25px;
            text-align: left;
            line-height: 1.6;
        }

        /* Social proof styling */
        .social-proof {
            background-color: rgba(99, 179, 237, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 14px;
            color: #bbd0ff;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .social-proof i {
            margin-right: 8px;
            color: #63b3ed;
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="flow-container">
        <svg class="flow-lines" width="100%" height="100%" viewBox="0 0 800 300">
            <path class="flow-path" d="M0,150 C100,50 200,250 300,100 S500,150 800,70" />
            <path class="flow-path" d="M0,100 C150,200 250,70 400,150 S600,50 800,180" style="animation-delay: -5s;" />
            <path class="flow-path" d="M0,200 C120,100 220,180 350,120 S550,200 800,120" style="animation-delay: -10s;" />
        </svg>
    </div>

    <!-- Main content -->
    <div class="main-container">
        <div class="payment-container">
            <div class="payment-header">
                <!-- Replace single logo with Proxy402 by Fewsats branding -->
                <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                    <span style="font-size: 24px; font-weight: 600; color: #fff;">Proxy402</span>
                    <span style="margin: 0 5px; font-size: 16px; color: #bbd0ff;">by</span>
                    <a href="https://fewsats.com" target="_blank" rel="noopener noreferrer">
                        <img src="/static/img/logo.svg" alt="Fewsats Logo" style="height: 24px; vertical-align: middle;">
                    </a>
                </div>
                
                <!-- Display cover image if available -->
                {{if .CoverURL}}
                <img src="{{.CoverURL}}" alt="Content preview" class="cover-image">
                {{end}}
                
                <!-- Display title -->
                <h1 class="payment-title">{{if .Title}}{{.Title}}{{else if eq .ResourceType "file"}}{{if .OriginalFilename}}Access: {{.OriginalFilename}}{{else}}File Access{{end}}{{else}}Access Protected Content{{end}}</h1>
                
                <!-- Display description -->
                {{if .Description}}
                <div class="resource-description">{{.Description}}</div>
                {{else if eq .ResourceType "file"}}
                <p class="payment-subtitle">
                    Pay to download {{if .OriginalFilename}}<span class="resource-name">{{.OriginalFilename}}</span>{{else}}this file{{end}}
                </p>
                {{else}}
                <p class="payment-subtitle">
                    Pay to access this content
                </p>
                {{end}}
            </div>
            
            {{if .ErrorMessage}}
            <div class="error-message">
                <strong>Error:</strong> {{.ErrorMessage}}
            </div>
            {{end}}
            
            <div class="payment-details">
                {{if eq .ResourceType "file"}}
                {{if .OriginalFilename}}
                <div class="payment-detail-item">
                    <span class="detail-label">File:</span>
                    <span class="detail-value">{{.OriginalFilename}}</span>
                </div>
                {{end}}
                {{else}}
                <div class="payment-detail-item">
                    <span class="detail-label">Resource:</span>
                    <span class="detail-value">{{.Resource}}</span>
                </div>
                {{end}}
                <div class="payment-detail-item">
                    <span class="detail-label">Amount:</span>
                    <span class="detail-value">${{.AmountFormatted}} USD</span>
                </div>
            </div>
            
            <!-- Social proof element -->
            <div class="social-proof">
                <i data-lucide="users" width="16" height="16"></i>
                <span>People are accessing content right now</span>
            </div>
            
            <div class="payment-footer">
                <p>Secured by <a href="https://proxy402.com" target="_blank">Proxy402</a> | <a href="https://www.x402.org" target="_blank">Learn about x402</a></p>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        document.addEventListener("DOMContentLoaded", function() {
            lucide.createIcons();
        });
    </script>
</body>
</html> 